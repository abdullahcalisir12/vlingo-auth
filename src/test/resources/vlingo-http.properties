# Copyright 2012-2018 Vaughn Vernon
#
# This Source Code Form is subject to the terms of the
# Mozilla Public License, v. 2.0. If a copy of the MPL
# was not distributed with this file, You can obtain
# one at https://mozilla.org/MPL/2.0/.

# vlingo/http properties

#=====================================
# server
#=====================================

server.http.port = 8080
server.dispatcher.pool = 10
server.buffer.pool.size = 2000
server.message.buffer.size = 65535
server.probe.interval = 10
server.probe.timeout = 10
server.request.missing.content.timeout = 100

#=====================================
# tenant resources
#=====================================

resource.name.tenant = [subscribe, queryTenant, activate, deactivate, description, name, provisionGroup, provisionRole, registerUser]

resource.tenant.handler = io.vlingo.auth.infra.resource.TenantResource
resource.tenant.pool = 10
resource.tenant.disallowPathParametersWithSlash = true

action.tenant.subscribe.method = POST
action.tenant.subscribe.uri = /tenants
action.tenant.subscribe.to = subscribeFor(body:io.vlingo.auth.infra.resource.TenantData tenantData)
action.tenant.subscribe.permission = io.vlingo.auth.TenantRepresentative

action.tenant.activate.method = PATCH
action.tenant.activate.uri = /tenants/{tenantId}/activate
action.tenant.activate.to = activate(String tenantId)
action.tenant.activate.permission = io.vlingo.auth.TenantRepresentative

action.tenant.deactivate.method = PATCH
action.tenant.deactivate.uri = /tenants/{tenantId}/deactivate
action.tenant.deactivate.to = deactivate(String tenantId)
action.tenant.deactivate.permission = io.vlingo.auth.TenantRepresentative

action.tenant.description.method = PATCH
action.tenant.description.uri = /tenants/{tenantId}/description
action.tenant.description.to = changeDescription(String tenantId, body:String description)
action.tenant.description.permission = io.vlingo.auth.TenantRepresentative

action.tenant.name.method = PATCH
action.tenant.name.uri = /tenants/{tenantId}/name
action.tenant.name.to = changeName(String tenantId, body:String name)
action.tenant.name.permission = io.vlingo.auth.TenantRepresentative

action.tenant.provisionGroup.method = POST
action.tenant.provisionGroup.uri = /tenants/{tenantId}/groups
action.tenant.provisionGroup.to = provisionGroup(String tenantId, body:io.vlingo.auth.infra.resource.GroupData groupData)
action.tenant.provisionGroup.permission = io.vlingo.auth.TenantRepresentative

action.tenant.provisionRole.method = POST
action.tenant.provisionRole.uri = /tenants/{tenantId}/roles
action.tenant.provisionRole.to = provisionRole(String tenantId, body:io.vlingo.auth.infra.resource.RoleData roleData)
action.tenant.provisionRole.permission = io.vlingo.auth.TenantRepresentative"

action.tenant.registerUser.method = POST
action.tenant.registerUser.uri = /tenants/{tenantId}/users
action.tenant.registerUser.to = registerUser(String tenantId, body:io.vlingo.auth.infra.resource.UserRegistrationData userData)
action.tenant.registerUser.permission = io.vlingo.auth.TenantRepresentative

action.tenant.queryTenant.method = GET
action.tenant.queryTenant.uri = /tenants/{tenantId}
action.tenant.queryTenant.to = queryTenant(String tenantId)
action.tenant.registerUser.permission = io.vlingo.auth.TenantQuery


#=====================================
# role resources
#=====================================

resource.name.role = [description, assignGroup, unassignGroup, assignUser, unassignUser, attach, detach, queryRole, queryRolePermission, queryRoleGroup, queryRoleUser]

resource.role.handler = io.vlingo.auth.infra.resource.RoleResource
resource.role.pool = 10
resource.role.disallowPathParametersWithSlash = true

action.role.description.method = PATCH
action.role.description.uri = /tenants/{tenantId}/roles/{roleName}/description
action.role.description.to = changeDescription(String tenantId, String roleName, body:java.lang.String description)
action.role.description.permission = io.vlingo.auth.Administrator

action.role.assignGroup.method = PUT
action.role.assignGroup.uri = /tenants/{tenantId}/roles/{roleName}/groups
action.role.assignGroup.to = assignGroup(String tenantId, String roleName, body:java.lang.String groupName)
action.role.assignGroup.permission = io.vlingo.auth.Administrator

action.role.unassignGroup.method = DELETE
action.role.unassignGroup.uri = /tenants/{tenantId}/roles/{roleName}/groups/{groupName}
action.role.unassignGroup.to = unassignGroup(String tenantId, String roleName, String groupName)
action.role.unassignGroup.permission = io.vlingo.auth.Administrator

action.role.assignUser.method = PUT
action.role.assignUser.uri = /tenants/{tenantId}/roles/{roleName}/users
action.role.assignUser.to = assignUser(String tenantId, String roleName, body:java.lang.String username)
action.role.assignUser.permission = io.vlingo.auth.Administrator

action.role.unassignUser.method = DELETE
action.role.unassignUser.uri = /tenants/{tenantId}/roles/{roleName}/users/{username}
action.role.unassignUser.to = unassignUser(String tenantId, String roleName, String username)
action.role.unassignUser.permission = io.vlingo.auth.Administrator

action.role.attach.method = PUT
action.role.attach.uri = /tenants/{tenantId}/roles/{roleName}/permissions
action.role.attach.to = attach(String tenantId, String roleName, body:java.lang.String permissionName)
action.role.attach.permission = io.vlingo.auth.Administrator

action.role.detach.method = DELETE
action.role.detach.uri = /tenants/{tenantId}/roles/{roleName}/permissions/{permissionName}
action.role.detach.to = detach(String tenantId, String roleName, String permissionName)
action.role.detach.permission = io.vlingo.auth.Administrator

action.role.role.method = GET
action.role.role.uri = /tenants/{tenantId}/roles/{roleName}
action.role.role.to = role(String tenantId, String roleName)
action.role.role.permission = io.vlingo.auth.RoleQuery

action.role.permission.method = GET
action.role.permission.uri = /tenants/{tenantId}/roles/{roleName}/permissions/{permissionName}
action.role.permission.to = permission(String tenantId, String roleName, String permissionName)
action.role.permission.permission = io.vlingo.auth.RoleQuery

action.role.group.method = GET
action.role.group.uri = /tenants/{tenantId}/roles/{roleName}/groups/{groupName}
action.role.group.to = group(String tenantId, String roleName, String groupName)
action.role.group.permission = io.vlingo.auth.RoleQuery

action.role.user.method = GET
action.role.user.uri = /tenants/{tenantId}/roles/{roleName}/users/{username}
action.role.user.to = user(String tenantId, String roleName, String username)
action.role.user.permission = io.vlingo.auth.RoleQuery
